#!/bin/bash
# 渗透测试常用工具一键安装脚本
set -e

echo "[+] 开始安装渗透测试常用工具..."

# 检测系统类型
if [ -f /etc/debian_version ]; then
  OS=debian
elif [ -f /etc/redhat-release ]; then
  OS=centos
else
  echo "[!] 未知系统类型，请手动安装依赖。"
  exit 1
fi

# 工具列表
TOOLS=(nmap masscan hydra sqlmap gobuster dirsearch whatweb nikto john metasploit-framework seclists)

# 安装函数
install_tools_debian() {
  sudo apt-get update -y
  sudo apt-get install -y nmap masscan hydra sqlmap gobuster dirsearch whatweb nikto john seclists
  # metasploit-framework
  curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfupdate | sudo bash
}

install_tools_centos() {
  sudo yum makecache
  sudo yum install -y epel-release
  sudo yum install -y nmap masscan hydra whatweb nikto john
  # 其他工具用pip或源码安装
  sudo yum install -y python3-pip git
  sudo pip3 install sqlmap dirsearch gobuster
  # metasploit-framework
  curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfupdate | sudo bash
  # seclists
  if [ ! -d /usr/share/seclists ]; then
    sudo git clone https://github.com/danielmiessler/SecLists.git /usr/share/seclists
  fi
}

if [ "$OS" = "debian" ]; then
  install_tools_debian
elif [ "$OS" = "centos" ]; then
  install_tools_centos
fi

echo "[+] 渗透测试常用工具安装完成。"
